{"version":3,"sources":["../src/config.ts","../src/formatters.ts","../src/utils.ts","../src/browser.ts","../src/timing.ts","../src/browser-entry.ts"],"names":["DEFAULT_CONFIG","VALID_LOG_LEVELS","parseLogLevel","value","defaultValue","normalized","parseBoolean","parseFileSize","sizeMatch","size","parseMaxFiles","durationMatch","amount","cachedConfig","getConfig","level","isLoggingEnabled","shouldLog","config","priorities","COLORS","RESET","formatTimestamp","timestamp","formatLevel","formatMessage","message","context","contextStr","key","formattedValue","formatForConsole","formattedTimestamp","formattedLevel","formattedMessage","formatBrowserLogEntry","isBrowser","generateUUID","c","r","createUnixTimestamp","STORAGE_KEY","MAX_ENTRIES","BrowserLoggerImpl","options","__publicField","entry","formatted","stored","newEntry","parsed","a","b","instance","getInstance","createBrowserLogger","now","seconds","nanoseconds","nowMicro","formatDuration","ms","time","fn","start","result","end","duration","timeAsync","Stopwatch","current","label","lapTime","DEFAULT_THRESHOLDS","PerformanceLevel","checkPerformance","thresholds","operationName","createPerformanceTracker","logger","defaultThresholds","operation","check","createThrottledLogger","intervals","lastLogged","threshold","currentTime","last","MetricsAggregator","existing","values","sorted","count","min","max","avg","percentile","p","idx","perf","measure"],"mappings":";0KAoCA,IAAMA,CAAAA,CAA8C,CAClD,OAAA,CAAS,IAAA,CACT,gBAAiB,IAAA,CACjB,iBAAA,CAAmB,IAAA,CACnB,WAAA,CAAa,QAAA,CACb,QAAA,CAAU,GACV,MAAA,CAAQ,SAAA,CACR,UAAA,CAAY,IAAA,CACZ,iBAAA,CAAmB,IACrB,EAKMC,CAAAA,CAAmB,CAAC,OAAA,CAAS,MAAA,CAAQ,MAAA,CAAQ,OAAA,CAAS,OAAO,CAAA,CAKnE,SAASC,CAAAA,CAAcC,CAAAA,CAA2BC,CAAAA,CAAkC,CAClF,GAAI,CAACD,CAAAA,CACH,OAAOC,CAAAA,CAET,IAAMC,CAAAA,CAAaF,EAAM,WAAA,EAAY,CACrC,OAAIF,CAAAA,CAAiB,QAAA,CAASI,CAAsB,EAC3CA,CAAAA,EAET,OAAA,CAAQ,IAAA,CAAK,CAAA,mBAAA,EAAsBF,CAAK,CAAA,kBAAA,EAAqBC,CAAY,CAAA,CAAA,CAAG,CAAA,CACrEA,CAAAA,CACT,CAKA,SAASE,CAAAA,CAAaH,EAA2BC,CAAAA,CAAgC,CAC/E,OAAID,CAAAA,GAAU,MAAA,CACLC,CAAAA,CAEFD,EAAM,WAAA,EAAY,GAAM,MACjC,CAKA,SAASI,CAAAA,CAAcJ,EAA2BC,CAAAA,CAA8B,CAC9E,GAAI,CAACD,CAAAA,CACH,OAAOC,EAGT,IAAMI,CAAAA,CAAYL,CAAAA,CAAM,WAAA,EAAY,CAAE,KAAA,CAAM,kBAAkB,CAAA,CAC9D,GAAI,CAACK,CAAAA,GAAY,CAAC,CAAA,CAChB,OAAOJ,CAAAA,CAGT,IAAMK,CAAAA,CAAO,QAAA,CAASD,CAAAA,CAAU,CAAC,EAAG,EAAE,CAAA,CAGtC,OAFaA,CAAAA,CAAU,CAAC,CAAA,EAAK,QAG3B,KAAK,IACH,OAAOC,CAAAA,CAAO,KAAO,IAAA,CAAO,IAAA,CAC9B,KAAK,GAAA,CACH,OAAOA,CAAAA,CAAO,KAAO,IAAA,CACvB,KAAK,GAAA,CACH,OAAOA,CAAAA,CAAO,IAAA,CAChB,QACE,OAAOA,CACX,CACF,CAKA,SAASC,CAAAA,CAAcP,EAA2BC,CAAAA,CAA8B,CAC9E,GAAI,CAACD,CAAAA,CACH,OAAOC,EAIT,IAAMO,CAAAA,CAAgBR,CAAAA,CAAM,WAAA,EAAY,CAAE,KAAA,CAAM,iBAAiB,CAAA,CACjE,GAAI,CAACQ,CAAAA,GAAgB,CAAC,CAAA,CACpB,OAAOP,CAAAA,CAGT,IAAMQ,CAAAA,CAAS,QAAA,CAASD,CAAAA,CAAc,CAAC,EAAG,EAAE,CAAA,CAG5C,OAFaA,CAAAA,CAAc,CAAC,CAAA,EAAK,QAG/B,KAAK,GAAA,CACH,OAAOC,CAAAA,CAAS,CAAA,CAClB,KAAK,GAAA,CACH,OAAO,IAAA,CAAK,IAAA,CAAKA,CAAAA,CAAS,EAAE,EAE9B,QACE,OAAOA,CACX,CACF,CAKA,IAAIC,EAAoC,IAAA,CAMjC,SAASC,CAAAA,EAA0B,CACxC,GAAID,CAAAA,CACF,OAAOA,CAAAA,CAGT,IAAME,CAAAA,CAAQb,CAAAA,CAAc,OAAA,CAAQ,GAAA,CAAI,sBAA0B,OAAO,CAAA,CAEzE,OAAAW,CAAAA,CAAe,CACb,GAAGb,EACH,KAAA,CAAAe,CAAAA,CACA,OAAA,CAAST,CAAAA,CAAa,OAAA,CAAQ,GAAA,CAAI,wBAA4BN,CAAAA,CAAe,OAAO,EACpF,eAAA,CAAiBM,CAAAA,CACf,QAAQ,GAAA,CAAI,wBAAA,CACZN,CAAAA,CAAe,eACjB,CAAA,CACA,iBAAA,CAAmBM,EAAa,MAAA,CAAWN,CAAAA,CAAe,iBAAiB,CAAA,CAC3E,WAAA,CAAaO,CAAAA,CAAc,QAAQ,GAAA,CAAI,YAAA,CAAiBP,CAAAA,CAAe,WAAW,CAAA,CAClF,QAAA,CAAUU,EAAc,OAAA,CAAQ,GAAA,CAAI,aAAA,CAAkBV,CAAAA,CAAe,QAAQ,CAAA,CAC7E,OAAQ,OAAA,CAAQ,GAAA,CAAI,OAAA,EAAcA,CAAAA,CAAe,MAAA,CACjD,UAAA,CAAYM,EAAa,MAAA,CAAWN,CAAAA,CAAe,UAAU,CAAA,CAC7D,iBAAA,CAAmBM,CAAAA,CAAa,OAAWN,CAAAA,CAAe,iBAAiB,CAC7E,CAAA,CAEOa,CACT,CAKO,SAASG,CAAAA,EAA4B,CAC1C,OAAOF,CAAAA,EAAU,CAAE,OACrB,CAKO,SAASG,CAAAA,CAAUF,CAAAA,CAA0B,CAClD,GAAI,CAACC,GAAiB,CACpB,OAAO,MAAA,CAGT,IAAME,CAAAA,CAASJ,CAAAA,GACTK,CAAAA,CAAuC,CAC3C,KAAA,CAAO,CAAA,CACP,IAAA,CAAM,CAAA,CACN,KAAM,CAAA,CACN,KAAA,CAAO,CAAA,CACP,KAAA,CAAO,CACT,CAAA,CAEA,OAAOA,CAAAA,CAAWJ,CAAK,CAAA,EAAKI,CAAAA,CAAWD,CAAAA,CAAO,KAAK,CACrD,CC5JA,IAAME,CAAAA,CAAmC,CACvC,KAAA,CAAO,UAAA,CACP,KAAM,UAAA,CACN,IAAA,CAAM,UAAA,CACN,KAAA,CAAO,UAAA,CACP,KAAA,CAAO,UACT,CAAA,CAEMC,CAAAA,CAAQ,SAAA,CAKP,SAASC,CAAAA,CAAgBC,CAAAA,CAAqC,CAEnE,OAAA,CADaA,CAAAA,CAAY,IAAI,IAAA,CAAKA,CAAS,CAAA,CAAI,IAAI,IAAA,EACvC,WAAA,EACd,CAKO,SAASC,CAAAA,CAAYT,EAAyB,CAEnD,OAAO,CAAA,EADOK,CAAAA,CAAOL,CAAK,CAAA,EAAKK,EAAO,IACvB,CAAA,EAAGL,CAAAA,CAAM,WAAA,EAAY,CAAE,MAAA,CAAO,CAAC,CAAC,CAAA,EAAGM,CAAK,CAAA,CACzD,CAYO,SAASI,EAAcC,CAAAA,CAAiBC,CAAAA,CAA8B,CAC3E,GAAI,CAACA,CAAAA,EAAW,OAAO,IAAA,CAAKA,CAAO,CAAA,CAAE,MAAA,GAAW,CAAA,CAC9C,OAAOD,EAGT,IAAME,CAAAA,CAAa,MAAA,CAAO,OAAA,CAAQD,CAAO,CAAA,CACtC,IAAI,CAAC,CAACE,CAAAA,CAAK1B,CAAK,CAAA,GAAM,CACrB,IAAM2B,CAAAA,CAAiB,OAAO3B,CAAAA,EAAU,QAAA,CAAW,IAAA,CAAK,SAAA,CAAUA,CAAK,CAAA,CAAI,MAAA,CAAOA,CAAK,CAAA,CACvF,OAAO,CAAA,CAAA,EAAI0B,CAAG,CAAA,CAAA,EAAIC,CAAc,CAAA,CAClC,CAAC,CAAA,CACA,IAAA,CAAK,EAAE,CAAA,CAEV,OAAO,CAAA,EAAGJ,CAAO,CAAA,EAAGE,CAAU,EAChC,CAoBO,SAASG,CAAAA,CACdhB,CAAAA,CACAW,CAAAA,CACAC,CAAAA,CACAJ,EACQ,CACR,IAAMS,CAAAA,CAAqBV,CAAAA,CAAgBC,CAAS,CAAA,CAC9CU,EAAiBT,CAAAA,CAAYT,CAAK,EAClCmB,CAAAA,CAAmBT,CAAAA,CAAcC,EAASC,CAAO,CAAA,CAEvD,OAAO,CAAA,CAAA,EAAIK,CAAkB,CAAA,EAAA,EAAKC,CAAc,CAAA,CAAA,EAAIC,CAAgB,CAAA,CACtE,CA8FO,SAASC,CAAAA,CACdpB,EACAW,CAAAA,CACAC,CAAAA,CAC2C,CAC3C,OAAO,CACL,KAAA,CAAAZ,EACA,OAAA,CAAAW,CAAAA,CACA,OAAA,CAAAC,CACF,CACF,CC5LO,SAASS,CAAAA,EAAqB,CACnC,OAAO,OAAO,MAAA,CAAW,GAC3B,CAoBO,SAASC,CAAAA,EAAuB,CAErC,OAAI,OAAO,MAAA,CAAW,KAAe,MAAA,CAAO,UAAA,CACnC,MAAA,CAAO,UAAA,EAAW,CAIpB,sCAAA,CAAuC,QAAQ,OAAA,CAASC,CAAAA,EAAK,CAClE,IAAMC,CAAAA,CAAK,IAAA,CAAK,QAAO,CAAI,EAAA,CAAM,CAAA,CAEjC,OAAA,CADUD,CAAAA,GAAM,GAAA,CAAMC,EAAKA,CAAAA,CAAI,CAAA,CAAO,CAAA,EAC7B,QAAA,CAAS,EAAE,CACtB,CAAC,CACH,CA2BO,SAASC,CAAAA,EAA8B,CAC5C,OAAO,KAAK,GAAA,EACd,CCnDA,IAAMC,CAAAA,CAAc,gBAAA,CAKdC,EAAc,GAAA,CAmBdC,CAAAA,CAAN,KAAkD,CAIhD,WAAA,CAAYC,CAAAA,CAAgC,EAAC,CAAG,CAHhDC,CAAAA,CAAA,IAAA,CAAQ,SAAA,CAAA,CACRA,CAAAA,CAAA,KAAQ,QAAA,CAAS/B,CAAAA,EAAU,CAAA,CAGzB,IAAA,CAAK,OAAA,CAAU,CACb,WAAY8B,CAAAA,CAAQ,UAAA,EAAcF,EAClC,UAAA,CAAYE,CAAAA,CAAQ,YAAcH,CAAAA,CAClC,cAAA,CAAgBG,CAAAA,CAAQ,cAAA,EAAkB,IAAA,CAC1C,kBAAA,CAAoBA,EAAQ,kBAAA,EAAsB,IACpD,EACF,CAKQ,GAAA,CAAI7B,CAAAA,CAAiBW,EAAiBC,CAAAA,CAA4B,CAKxE,GAJI,CAACX,CAAAA,EAAiB,EAIlB,CAACC,CAAAA,CAAUF,CAAK,CAAA,CAClB,OAGF,IAAM+B,CAAAA,CAAQX,EAAsBpB,CAAAA,CAAOW,CAAAA,CAASC,CAAO,CAAA,CACrDJ,CAAAA,CAAYiB,CAAAA,GAGlB,GAAI,IAAA,CAAK,OAAA,CAAQ,cAAA,CAAgB,CAC/B,IAAMO,EAAYhB,CAAAA,CAAiBhB,CAAAA,CAAOW,CAAAA,CAASC,CAAAA,CAASJ,CAAS,CAAA,CACrE,QAAQ,GAAA,CAAIwB,CAAS,EACvB,CAGI,IAAA,CAAK,OAAA,CAAQ,oBAAsBX,CAAAA,EAAU,EAC/C,IAAA,CAAK,YAAA,CAAaU,CAAAA,CAAOvB,CAAS,EAEtC,CAKQ,YAAA,CAAauB,CAAAA,CAAkDvB,CAAAA,CAAyB,CAC9F,GAAKa,GAAU,CAIf,GAAI,CACF,IAAMY,CAAAA,CAAS,IAAA,CAAK,kBAAiB,CAE/BC,CAAAA,CAA4B,CAChC,GAAGH,CAAAA,CACH,EAAA,CAAIT,GAAa,CACjB,SAAA,CAAAd,CACF,CAAA,CAIA,IAFAyB,CAAAA,CAAO,QAAQ,IAAA,CAAKC,CAAQ,CAAA,CAErBD,CAAAA,CAAO,OAAA,CAAQ,MAAA,CAAS,KAAK,OAAA,CAAQ,UAAA,EAC1CA,CAAAA,CAAO,OAAA,CAAQ,KAAA,EAAM,CAGvBA,EAAO,WAAA,CAAczB,CAAAA,CAErB,aAAa,OAAA,CAAQ,IAAA,CAAK,QAAQ,UAAA,CAAY,IAAA,CAAK,SAAA,CAAUyB,CAAM,CAAC,EACtE,MAAQ,CACN,OAAA,CAAQ,IAAA,CAAK,4DAA4D,EAC3E,CACF,CAKQ,gBAAA,EAA+B,CACrC,GAAI,CAACZ,CAAAA,EAAU,CACb,OAAO,CAAE,OAAA,CAAS,EAAC,CAAG,WAAA,CAAa,CAAA,CAAG,QAAS,CAAE,CAAA,CAGnD,GAAI,CACF,IAAMY,CAAAA,CAAS,aAAa,OAAA,CAAQ,IAAA,CAAK,OAAA,CAAQ,UAAU,CAAA,CAC3D,GAAI,CAACA,CAAAA,CACH,OAAO,CAAE,OAAA,CAAS,EAAC,CAAG,YAAa,CAAA,CAAG,OAAA,CAAS,CAAE,CAAA,CAGnD,IAAME,CAAAA,CAAS,KAAK,KAAA,CAAMF,CAAM,CAAA,CAChC,OAAO,CACL,OAAA,CAAS,MAAM,OAAA,CAAQE,CAAAA,CAAO,OAAO,CAAA,CAAIA,CAAAA,CAAO,OAAA,CAAU,EAAC,CAC3D,WAAA,CAAaA,CAAAA,CAAO,WAAA,EAAe,CAAA,CACnC,OAAA,CAASA,EAAO,OAAA,EAAW,CAC7B,CACF,CAAA,KAAQ,CACN,OAAO,CAAE,OAAA,CAAS,EAAC,CAAG,WAAA,CAAa,CAAA,CAAG,OAAA,CAAS,CAAE,CACnD,CACF,CAEA,KAAA,CAAMxB,CAAAA,CAAiBC,CAAAA,CAA4B,CACjD,IAAA,CAAK,GAAA,CAAI,OAAA,CAASD,CAAAA,CAASC,CAAO,EACpC,CAEA,IAAA,CAAKD,CAAAA,CAAiBC,CAAAA,CAA4B,CAChD,IAAA,CAAK,GAAA,CAAI,OAAQD,CAAAA,CAASC,CAAO,EACnC,CAEA,IAAA,CAAKD,CAAAA,CAAiBC,EAA4B,CAChD,IAAA,CAAK,GAAA,CAAI,MAAA,CAAQD,CAAAA,CAASC,CAAO,EACnC,CAEA,KAAA,CAAMD,CAAAA,CAAiBC,CAAAA,CAA4B,CACjD,IAAA,CAAK,IAAI,OAAA,CAASD,CAAAA,CAASC,CAAO,EACpC,CAEA,aAAA,EAAmC,CAEjC,OAAO,CAAC,GADO,IAAA,CAAK,gBAAA,EAAiB,CACnB,OAAO,CAAA,CAAE,IAAA,CAAK,CAACwB,CAAAA,CAAGC,CAAAA,GAAMD,CAAAA,CAAE,UAAYC,CAAAA,CAAE,SAAS,CACrE,CAEA,eAAA,EAAwB,CACtB,GAAKhB,CAAAA,EAAU,CAIf,GAAI,CACF,YAAA,CAAa,UAAA,CAAW,KAAK,OAAA,CAAQ,UAAU,EACjD,CAAA,KAAQ,CACN,OAAA,CAAQ,KAAK,6CAA6C,EAC5D,CACF,CAEA,MAAM,KAAA,EAAuB,CAC3B,OAAA,CAAQ,GAAA,CAAI,kEAAkE,EAChF,CACF,CAAA,CAKIiB,EAAqC,IAAA,CAKzC,SAASC,CAAAA,EAAiC,CACxC,OAAKD,CAAAA,GACHA,EAAW,IAAIV,CAAAA,CAAAA,CAEVU,CACT,CAKsCC,IAKtC,SAASC,CAAAA,CAAoBX,CAAAA,CAAgD,CAC3E,OAAO,IAAID,CAAAA,CAAkBC,CAAO,CACtC,CC1LO,SAASY,CAAAA,EAAc,CAG5B,GAAI,OAAO,YAAgB,GAAA,EAAe,WAAA,CAAY,KAAO,WAAA,CAAY,GAAA,EAAI,CAAI,CAAA,CAC/E,OAAO,WAAA,CAAY,KAAI,CAGzB,GAAI,OAAO,OAAA,CAAY,GAAA,EAAe,OAAA,CAAQ,OAAQ,CACpD,GAAM,CAACC,CAAAA,CAASC,CAAW,CAAA,CAAI,QAAQ,MAAA,EAAO,CAC9C,OAAOD,CAAAA,CAAU,GAAA,CAAOC,CAAAA,CAAc,GACxC,CAEA,OAAO,IAAA,CAAK,GAAA,EACd,CAKO,SAASC,CAAAA,EAAmB,CACjC,OAAOH,CAAAA,EAAI,CAAI,GACjB,CAKO,SAASI,CAAAA,CAAeC,CAAAA,CAAoB,CACjD,OAAIA,CAAAA,CAAK,EACA,CAAA,EAAA,CAAIA,CAAAA,CAAK,GAAA,EAAM,OAAA,CAAQ,CAAC,CAAC,UAE9BA,CAAAA,CAAK,GAAA,CACA,CAAA,EAAGA,CAAAA,CAAG,OAAA,CAAQ,CAAC,CAAC,CAAA,EAAA,CAAA,CAErBA,CAAAA,CAAK,GAAA,CACA,CAAA,EAAA,CAAIA,CAAAA,CAAK,GAAA,EAAM,QAAQ,CAAC,CAAC,CAAA,CAAA,CAAA,CAE3B,CAAA,EAAA,CAAIA,CAAAA,CAAK,GAAA,EAAO,QAAQ,CAAC,CAAC,CAAA,CAAA,CACnC,CAmBO,SAASC,CAAAA,CAAQC,EAA2C,CACjE,IAAMC,CAAAA,CAAQR,CAAAA,EAAI,CACZS,CAAAA,CAASF,GAAG,CACZG,CAAAA,CAAMV,CAAAA,EAAI,CACVW,CAAAA,CAAW,IAAA,CAAK,IAAID,CAAAA,CAAMF,CAAAA,CAAO,GAAI,CAAA,CAE3C,OAAO,CACL,OAAAC,CAAAA,CACA,QAAA,CAAAE,EACA,SAAA,CAAWP,CAAAA,CAAeO,CAAQ,CAAA,CAClC,KAAA,CAAAH,CAAAA,CACA,GAAA,CAAAE,CACF,CACF,CAKA,eAAsBE,CAAAA,CAAaL,CAAAA,CAA6D,CAC9F,IAAMC,CAAAA,CAAQR,GAAI,CACZS,CAAAA,CAAS,MAAMF,CAAAA,EAAG,CAClBG,CAAAA,CAAMV,GAAI,CACVW,CAAAA,CAAW,IAAA,CAAK,GAAA,CAAID,CAAAA,CAAMF,CAAAA,CAAO,GAAI,CAAA,CAE3C,OAAO,CACL,MAAA,CAAAC,CAAAA,CACA,QAAA,CAAAE,EACA,SAAA,CAAWP,CAAAA,CAAeO,CAAQ,CAAA,CAClC,KAAA,CAAAH,CAAAA,CACA,IAAAE,CACF,CACF,CAKO,IAAMG,CAAAA,CAAN,KAAgB,CAMrB,WAAA,EAAc,CALdxB,CAAAA,CAAA,IAAA,CAAQ,WAAA,CAAA,CACRA,CAAAA,CAAA,KAAQ,MAAA,CAA4B,IAAI,GAAA,CAAA,CACxCA,CAAAA,CAAA,IAAA,CAAQ,gBAAA,CAAiB,GACzBA,CAAAA,CAAA,IAAA,CAAQ,SAAA,CAAU,IAAA,CAAA,CAGhB,IAAA,CAAK,SAAA,CAAYW,IACnB,CAKA,OAAA,EAAkB,CAChB,IAAMc,CAAAA,CAAUd,GAAI,CACpB,OAAI,IAAA,CAAK,OAAA,CACA,IAAA,CAAK,GAAA,CAAIc,EAAU,IAAA,CAAK,SAAA,CAAW,CAAC,CAAA,CAEtC,IAAA,CAAK,cACd,CAKA,gBAAA,EAA2B,CACzB,OAAOV,CAAAA,CAAe,IAAA,CAAK,OAAA,EAAS,CACtC,CAKA,GAAA,CAAIW,CAAAA,CAAuB,CACzB,IAAMC,EAAU,IAAA,CAAK,OAAA,GACrB,OAAA,IAAA,CAAK,IAAA,CAAK,IAAID,CAAAA,CAAOC,CAAO,CAAA,CACrBA,CACT,CAKA,OAAA,EAA+B,CAC7B,OAAO,IAAI,GAAA,CAAI,IAAA,CAAK,IAAI,CAC1B,CAKA,MAAA,CAAOD,CAAAA,CAAmC,CACxC,OAAO,IAAA,CAAK,IAAA,CAAK,IAAIA,CAAK,CAC5B,CAKA,KAAA,EAAc,CACZ,IAAA,CAAK,UAAYf,CAAAA,EAAI,CACrB,IAAA,CAAK,IAAA,CAAK,KAAA,EAAM,CAChB,KAAK,cAAA,CAAiB,CAAA,CACtB,IAAA,CAAK,OAAA,CAAU,KACjB,CAKA,MAAe,CACb,OAAA,IAAA,CAAK,cAAA,CAAiB,IAAA,CAAK,OAAA,EAAQ,CACnC,KAAK,OAAA,CAAU,KAAA,CACR,IAAA,CAAK,cACd,CAKA,OAAA,EAAqB,CACnB,OAAA,IAAA,CAAK,KAAA,EAAM,CACJ,IACT,CAKA,UAAA,EAAqB,CACnB,OAAO,IAAA,CAAK,OAAA,EACd,CACF,CAAA,CAeaiB,EAA2D,CACtE,GAAA,CAAK,CAAE,OAAA,CAAS,GAAA,CAAK,QAAA,CAAU,GAAK,CAAA,CACpC,EAAA,CAAI,CAAE,OAAA,CAAS,GAAA,CAAK,QAAA,CAAU,GAAI,CAAA,CAClC,KAAA,CAAO,CAAE,OAAA,CAAS,EAAA,CAAI,QAAA,CAAU,EAAG,CAAA,CACnC,MAAA,CAAQ,CAAE,OAAA,CAAS,EAAA,CAAI,QAAA,CAAU,GAAI,CAAA,CACrC,IAAA,CAAM,CAAE,OAAA,CAAS,EAAA,CAAI,QAAA,CAAU,GAAI,CAAA,CACnC,QAAA,CAAU,CAAE,OAAA,CAAS,GAAA,CAAK,QAAA,CAAU,GAAK,CAC3C,CAAA,CAKYC,CAAAA,CAAAA,CAAAA,CAAAA,GACVA,CAAAA,CAAA,EAAA,CAAK,IAAA,CACLA,EAAA,OAAA,CAAU,SAAA,CACVA,CAAAA,CAAA,QAAA,CAAW,UAAA,CAHDA,CAAAA,CAAAA,EAAAA,CAAAA,EAAA,IAyBL,SAASC,CAAAA,CACdR,CAAAA,CACAS,CAAAA,CAAmCH,CAAAA,CAAmB,GAAA,CACtDI,EAAgB,WAAA,CACE,CAClB,OAAIV,CAAAA,EAAYS,CAAAA,CAAW,QAAA,CAClB,CACL,KAAA,CAAO,UAAA,CACP,QAAA,CAAAT,CAAAA,CACA,SAAA,CAAWP,CAAAA,CAAeO,CAAQ,CAAA,CAClC,SAAA,CAAW,UAAA,CACX,OAAA,CAAS,CAAA,EAAGU,CAAa,mBAAmBjB,CAAAA,CAAeO,CAAQ,CAAC,CAAA,sBAAA,EAAyBP,CAAAA,CAAegB,CAAAA,CAAW,QAAQ,CAAC,CAAA,CAAA,CAClI,CAAA,CAGET,CAAAA,EAAYS,CAAAA,CAAW,OAAA,CAClB,CACL,KAAA,CAAO,SAAA,CACP,QAAA,CAAAT,CAAAA,CACA,SAAA,CAAWP,CAAAA,CAAeO,CAAQ,CAAA,CAClC,SAAA,CAAW,SAAA,CACX,OAAA,CAAS,CAAA,EAAGU,CAAa,aAAajB,CAAAA,CAAeO,CAAQ,CAAC,CAAA,qBAAA,EAAwBP,CAAAA,CAAegB,CAAAA,CAAW,OAAO,CAAC,CAAA,CAAA,CAC1H,CAAA,CAGK,CACL,KAAA,CAAO,IAAA,CACP,SAAAT,CAAAA,CACA,SAAA,CAAWP,CAAAA,CAAeO,CAAQ,CAAA,CAClC,OAAA,CAAS,GAAGU,CAAa,CAAA,cAAA,EAAiBjB,CAAAA,CAAeO,CAAQ,CAAC,CAAA,CACpE,CACF,CA0BO,SAASW,CAAAA,CACdC,CAAAA,CACAC,CAAAA,CAA0CP,CAAAA,CAAmB,IAC7D,CACA,OAAO,CAIL,KAAA,CAASQ,CAAAA,CAAmBlB,EAAapC,CAAAA,CAAoD,CAC3F,IAAMqC,CAAAA,CAAQR,CAAAA,EAAI,CACZS,EAASF,CAAAA,EAAG,CACZG,CAAAA,CAAMV,CAAAA,EAAI,CACVW,CAAAA,CAAW,KAAK,GAAA,CAAID,CAAAA,CAAMF,CAAAA,CAAO,GAAI,CAAA,CAErCkB,CAAAA,CAAQP,EAAiBR,CAAAA,CAAUa,CAAAA,CAAmBC,CAAS,CAAA,CAErE,OAAIC,CAAAA,CAAM,QAAU,IAAA,CAClBH,CAAAA,CAAO,YAAA,CAAaE,CAAAA,CAAWd,CAAAA,CAAUxC,CAAO,EAEhDoD,CAAAA,CAAO,gBAAA,CAAiBE,CAAAA,CAAWd,CAAAA,CAAUe,CAAAA,CAAM,SAAA,CAAYvD,CAAO,CAAA,CAGjE,CACL,MAAA,CAAAsC,CAAAA,CACA,QAAA,CAAAE,CAAAA,CACA,UAAWP,CAAAA,CAAeO,CAAQ,CAAA,CAClC,KAAA,CAAAH,CAAAA,CACA,GAAA,CAAAE,CACF,CACF,CAAA,CAKA,MAAM,UAAA,CACJe,CAAAA,CACAlB,CAAAA,CACApC,EACuC,CACvC,IAAMqC,CAAAA,CAAQR,CAAAA,EAAI,CACZS,CAAAA,CAAS,MAAMF,CAAAA,EAAG,CAClBG,CAAAA,CAAMV,CAAAA,EAAI,CACVW,CAAAA,CAAW,KAAK,GAAA,CAAID,CAAAA,CAAMF,CAAAA,CAAO,GAAI,CAAA,CAErCkB,CAAAA,CAAQP,EAAiBR,CAAAA,CAAUa,CAAAA,CAAmBC,CAAS,CAAA,CAErE,OAAIC,CAAAA,CAAM,QAAU,IAAA,CAClBH,CAAAA,CAAO,YAAA,CAAaE,CAAAA,CAAWd,CAAAA,CAAUxC,CAAO,EAEhDoD,CAAAA,CAAO,gBAAA,CAAiBE,CAAAA,CAAWd,CAAAA,CAAUe,CAAAA,CAAM,SAAA,CAAYvD,CAAO,CAAA,CAGjE,CACL,MAAA,CAAAsC,CAAAA,CACA,QAAA,CAAAE,CAAAA,CACA,UAAWP,CAAAA,CAAeO,CAAQ,CAAA,CAClC,KAAA,CAAAH,CAAAA,CACA,GAAA,CAAAE,CACF,CACF,CAAA,CAKA,UAAA,EAAwB,CACtB,OAAO,IAAIG,CACb,CAAA,CAKA,KAAA,CAAMY,CAAAA,CAAmBd,CAAAA,CAAoC,CAC3D,OAAOQ,EAAiBR,CAAAA,CAAUa,CAAAA,CAAmBC,CAAS,CAChE,CACF,CACF,CAKO,SAASE,CAAAA,CACdJ,CAAAA,CACAK,CAAAA,CAAoD,CAClD,OAAA,CAAS,IACT,QAAA,CAAU,CACZ,CAAA,CACA,CACA,IAAMC,CAAAA,CAAkC,IAAI,GAAA,CAE5C,OAAO,CACL,YAAA,CAAc,CAACJ,CAAAA,CAAmBd,EAAkBxC,CAAAA,GAAyB,CAC3EoD,CAAAA,CAAO,YAAA,CAAaE,CAAAA,CAAWd,CAAAA,CAAUxC,CAAO,EAClD,CAAA,CACA,gBAAA,CAAkB,CAChBsD,CAAAA,CACAd,CAAAA,CACAmB,EACA3D,CAAAA,GACG,CACH,IAAME,CAAAA,CAAM,CAAA,EAAGoD,CAAS,IAAIK,CAAS,CAAA,CAAA,CAC/BC,CAAAA,CAAc,IAAA,CAAK,GAAA,EAAI,CACvBC,EAAOH,CAAAA,CAAW,GAAA,CAAIxD,CAAG,CAAA,EAAK,CAAA,CAAA,CAEhCyD,CAAAA,GAAc,YAAcC,CAAAA,CAAcC,CAAAA,EAAQJ,CAAAA,CAAUE,CAAS,CAAA,IACvEP,CAAAA,CAAO,iBAAiBE,CAAAA,CAAWd,CAAAA,CAAUmB,CAAAA,CAAW3D,CAAO,CAAA,CAC/D0D,CAAAA,CAAW,IAAIxD,CAAAA,CAAK0D,CAAW,CAAA,EAEnC,CACF,CACF,KAKaE,CAAAA,CAAN,KAAwB,CAAxB,WAAA,EAAA,CACL5C,CAAAA,CAAA,KAAQ,SAAA,CAAiC,IAAI,GAAA,EAAA,CAK7C,MAAA,CAAOhB,CAAAA,CAAa1B,CAAAA,CAAqB,CACvC,IAAMuF,CAAAA,CAAW,IAAA,CAAK,OAAA,CAAQ,GAAA,CAAI7D,CAAG,GAAK,EAAC,CAC3C6D,CAAAA,CAAS,IAAA,CAAKvF,CAAK,CAAA,CACnB,KAAK,OAAA,CAAQ,GAAA,CAAI0B,CAAAA,CAAK6D,CAAQ,EAChC,CAKA,SAAS7D,CAAAA,CAQA,CACP,IAAM8D,CAAAA,CAAS,IAAA,CAAK,OAAA,CAAQ,IAAI9D,CAAG,CAAA,CACnC,GAAI,CAAC8D,CAAAA,EAAUA,CAAAA,CAAO,SAAW,CAAA,CAC/B,OAAO,IAAA,CAGT,IAAMC,CAAAA,CAAS,CAAC,GAAGD,CAAM,CAAA,CAAE,IAAA,CAAK,CAACxC,CAAAA,CAAGC,CAAAA,GAAMD,EAAIC,CAAC,CAAA,CACzCyC,CAAAA,CAAQD,CAAAA,CAAO,MAAA,CACfE,CAAAA,CAAMF,EAAO,CAAC,CAAA,CACdG,CAAAA,CAAMH,CAAAA,CAAOC,CAAAA,CAAQ,CAAC,EACtBG,CAAAA,CAAMJ,CAAAA,CAAO,MAAA,CAAO,CAACzC,CAAAA,CAAGC,CAAAA,GAAMD,EAAIC,CAAAA,CAAG,CAAC,CAAA,CAAIyC,CAAAA,CAE1CI,CAAAA,CAAcC,CAAAA,EAAc,CAChC,IAAMC,CAAAA,CAAM,IAAA,CAAK,KAAA,CAAMN,CAAAA,CAAQK,CAAC,EAChC,OAAON,CAAAA,CAAO,IAAA,CAAK,GAAA,CAAIO,CAAAA,CAAKN,CAAAA,CAAQ,CAAC,CAAC,CACxC,CAAA,CAEA,OAAO,CACL,KAAA,CAAAA,EACA,GAAA,CAAAC,CAAAA,CACA,GAAA,CAAAC,CAAAA,CACA,GAAA,CAAAC,CAAAA,CACA,IAAKC,CAAAA,CAAW,EAAG,CAAA,CACnB,GAAA,CAAKA,CAAAA,CAAW,GAAI,EACpB,GAAA,CAAKA,CAAAA,CAAW,GAAI,CACtB,CACF,CAKA,gBAA2B,CACzB,OAAO,KAAA,CAAM,IAAA,CAAK,IAAA,CAAK,OAAA,CAAQ,MAAM,CACvC,CAKA,KAAA,EAAc,CACZ,IAAA,CAAK,QAAQ,KAAA,GACf,CACF,CAAA,CAKaG,CAAAA,CAAO,CAClB,IAAA5C,CAAAA,CACA,QAAA,CAAAG,CAAAA,CACA,cAAA,CAAAC,CAAAA,CACA,IAAA,CAAAE,EACA,SAAA,CAAAM,CAAAA,CACA,SAAA,CAAAC,CAAAA,CACA,kBAAA,CAAAI,CAAAA,CACA,iBAAAC,CAAAA,CACA,gBAAA,CAAAC,CAAAA,CACA,wBAAA,CAAAG,CAAAA,CACA,qBAAA,CAAAK,EACA,iBAAA,CAAAM,CACF,ECleO,SAASV,EAAAA,CAAOnC,CAAAA,CAA+D,CACpF,OAAOW,CAAAA,CAAoB,CACzB,cAAA,CAAgB,IAAA,CAChB,kBAAA,CAAoB,KACpB,UAAA,CAAY,GAAA,CACZ,UAAA,CAAY,gBACd,CAAC,CACH,CAKA,eAAsB8C,EAAAA,CACpB9B,CAAAA,CACAR,CAAAA,CAC0C,CAC1C,IAAMC,EAAQoC,CAAAA,CAAK,GAAA,EAAI,CACjBnC,CAAAA,CAAS,MAAMF,CAAAA,GACfI,CAAAA,CAAWiC,CAAAA,CAAK,GAAA,EAAI,CAAIpC,CAAAA,CAC9B,OAAO,CAAE,MAAA,CAAAC,CAAAA,CAAQ,QAAA,CAAAE,CAAS,CAC5B","file":"browser-entry.mjs","sourcesContent":["/**\n * MIT License\n *\n * Copyright (c) 2026 Zaob <zaob.ogn@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Configuration module for API Logger Integration\n *\n * Loads and validates environment variables, provides defaults,\n * and exposes configuration as a readonly object.\n */\n\nimport type { LoggerConfig, LogLevel } from './types';\n\n/**\n * Default configuration values\n */\nconst DEFAULT_CONFIG: Omit<LoggerConfig, 'level'> = {\n  enabled: true,\n  redactSensitive: true,\n  includeStackTrace: true,\n  maxFileSize: 10 * 1024 * 1024, // 10MB\n  maxFiles: 14, // 14 days\n  logDir: './_logs',\n  jsonFormat: true,\n  developmentFormat: true,\n};\n\n/**\n * Valid log levels\n */\nconst VALID_LOG_LEVELS = ['debug', 'info', 'warn', 'error', 'fatal'] as const;\n\n/**\n * Parse log level from environment variable\n */\nfunction parseLogLevel(value: string | undefined, defaultValue: LogLevel): LogLevel {\n  if (!value) {\n    return defaultValue;\n  }\n  const normalized = value.toLowerCase();\n  if (VALID_LOG_LEVELS.includes(normalized as LogLevel)) {\n    return normalized as LogLevel;\n  }\n  console.warn(`Invalid log level \"${value}\", using default \"${defaultValue}\"`);\n  return defaultValue;\n}\n\n/**\n * Parse boolean from environment variable\n */\nfunction parseBoolean(value: string | undefined, defaultValue: boolean): boolean {\n  if (value === undefined) {\n    return defaultValue;\n  }\n  return value.toLowerCase() === 'true';\n}\n\n/**\n * Parse file size string (e.g., \"10m\", \"1g\") to bytes\n */\nfunction parseFileSize(value: string | undefined, defaultValue: number): number {\n  if (!value) {\n    return defaultValue;\n  }\n\n  const sizeMatch = value.toLowerCase().match(/^(\\d+)([bkmg])?$/);\n  if (!sizeMatch?.[1]) {\n    return defaultValue;\n  }\n\n  const size = parseInt(sizeMatch[1], 10);\n  const unit = sizeMatch[2] ?? undefined;\n\n  switch (unit) {\n    case 'g':\n      return size * 1024 * 1024 * 1024;\n    case 'm':\n      return size * 1024 * 1024;\n    case 'k':\n      return size * 1024;\n    default:\n      return size;\n  }\n}\n\n/**\n * Parse max files string (e.g., \"14d\", \"10\") to days\n */\nfunction parseMaxFiles(value: string | undefined, defaultValue: number): number {\n  if (!value) {\n    return defaultValue;\n  }\n\n  // Handle duration format like \"14d\" for 14 days\n  const durationMatch = value.toLowerCase().match(/^(\\d+)([dwh])?$/);\n  if (!durationMatch?.[1]) {\n    return defaultValue;\n  }\n\n  const amount = parseInt(durationMatch[1], 10);\n  const unit = durationMatch[2] ?? undefined;\n\n  switch (unit) {\n    case 'w':\n      return amount * 7; // weeks to days\n    case 'h':\n      return Math.ceil(amount / 24); // hours to days (rounded up)\n    case 'd':\n    default:\n      return amount;\n  }\n}\n\n/**\n * Cached configuration object\n */\nlet cachedConfig: LoggerConfig | null = null;\n\n/**\n * Get the logger configuration\n * Loads from environment variables with defaults, caches the result\n */\nexport function getConfig(): LoggerConfig {\n  if (cachedConfig) {\n    return cachedConfig;\n  }\n\n  const level = parseLogLevel(process.env['NEXT_PUBLIC_LOG_LEVEL'], 'debug');\n\n  cachedConfig = {\n    ...DEFAULT_CONFIG,\n    level,\n    enabled: parseBoolean(process.env['NEXT_PUBLIC_LOG_ENABLED'], DEFAULT_CONFIG.enabled),\n    redactSensitive: parseBoolean(\n      process.env['API_LOG_REDACT_SENSITIVE'],\n      DEFAULT_CONFIG.redactSensitive\n    ),\n    includeStackTrace: parseBoolean(undefined, DEFAULT_CONFIG.includeStackTrace),\n    maxFileSize: parseFileSize(process.env['LOG_MAX_SIZE'], DEFAULT_CONFIG.maxFileSize),\n    maxFiles: parseMaxFiles(process.env['LOG_MAX_FILES'], DEFAULT_CONFIG.maxFiles),\n    logDir: process.env['LOG_DIR'] || DEFAULT_CONFIG.logDir,\n    jsonFormat: parseBoolean(undefined, DEFAULT_CONFIG.jsonFormat),\n    developmentFormat: parseBoolean(undefined, DEFAULT_CONFIG.developmentFormat),\n  };\n\n  return cachedConfig;\n}\n\n/**\n * Check if logging is enabled\n */\nexport function isLoggingEnabled(): boolean {\n  return getConfig().enabled;\n}\n\n/**\n * Check if a log level will be output\n */\nexport function shouldLog(level: LogLevel): boolean {\n  if (!isLoggingEnabled()) {\n    return false;\n  }\n\n  const config = getConfig();\n  const priorities: Record<LogLevel, number> = {\n    debug: 0,\n    info: 1,\n    warn: 2,\n    error: 3,\n    fatal: 4,\n  };\n\n  return priorities[level] >= priorities[config.level];\n}\n\n/**\n * Get the log directory path\n */\nexport function getLogDir(): string {\n  return getConfig().logDir;\n}\n\n/**\n * Check if running in development mode\n */\nexport function isDevelopment(): boolean {\n  return process.env['NODE_ENV'] === 'development';\n}\n\n/**\n * Check if running in production mode\n */\nexport function isProduction(): boolean {\n  return process.env['NODE_ENV'] === 'production';\n}\n\n/**\n * Get the current environment\n */\nexport function getEnvironment(): string {\n  return process.env['NODE_ENV'] || 'development';\n}\n\n/**\n * Reset the cached configuration (useful for testing)\n */\nexport function resetConfig(): void {\n  cachedConfig = null;\n}\n","/**\n * MIT License\n *\n * Copyright (c) 2026 Zaob <zaob.ogn@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Log formatters for API Logger Integration\n *\n * Provides formatting functions for console output (colored in dev, structured in prod)\n * and JSON output (Datadog/CloudWatch compatible).\n */\n\nimport { isDevelopment, getConfig } from './config';\nimport type { LogContext, LogLevel, BrowserLogEntry } from './types';\n\n/**\n * Colors for console output (ANSI escape codes)\n */\nconst COLORS: Record<LogLevel, string> = {\n  debug: '\\x1b[90m', // gray\n  info: '\\x1b[32m', // green\n  warn: '\\x1b[33m', // yellow\n  error: '\\x1b[31m', // red\n  fatal: '\\x1b[35m', // magenta\n};\n\nconst RESET = '\\x1b[0m';\n\n/**\n * Format a timestamp to ISO 8601 format\n */\nexport function formatTimestamp(timestamp?: number | string): string {\n  const date = timestamp ? new Date(timestamp) : new Date();\n  return date.toISOString();\n}\n\n/**\n * Format log level for console output (with color)\n */\nexport function formatLevel(level: LogLevel): string {\n  const color = COLORS[level] || COLORS.info;\n  return `${color}${level.toUpperCase().padEnd(5)}${RESET}`;\n}\n\n/**\n * Format log level for JSON output\n */\nexport function formatLevelJson(level: LogLevel): string {\n  return level.toUpperCase();\n}\n\n/**\n * Format the message for console output\n */\nexport function formatMessage(message: string, context?: LogContext): string {\n  if (!context || Object.keys(context).length === 0) {\n    return message;\n  }\n\n  const contextStr = Object.entries(context)\n    .map(([key, value]) => {\n      const formattedValue = typeof value === 'object' ? JSON.stringify(value) : String(value);\n      return ` ${key}=${formattedValue}`;\n    })\n    .join('');\n\n  return `${message}${contextStr}`;\n}\n\n/**\n * Format error object with stack trace\n */\nexport function formatError(error: Error | unknown): object {\n  if (!(error instanceof Error)) {\n    return { error: String(error) };\n  }\n\n  return {\n    message: error.message,\n    name: error.name,\n    stack: error.stack,\n  };\n}\n\n/**\n * Create a formatted log entry for console output (development mode)\n */\nexport function formatForConsole(\n  level: LogLevel,\n  message: string,\n  context?: LogContext,\n  timestamp?: number | string\n): string {\n  const formattedTimestamp = formatTimestamp(timestamp);\n  const formattedLevel = formatLevel(level);\n  const formattedMessage = formatMessage(message, context);\n\n  return `[${formattedTimestamp}] ${formattedLevel} ${formattedMessage}`;\n}\n\n/**\n * Create a structured log entry for JSON output (production mode)\n */\nexport interface JsonLogEntry {\n  '@timestamp': string;\n  level: string;\n  message: string;\n  context?: LogContext;\n  logger?: string;\n  service?: string;\n  trace?: string;\n  error?: object;\n}\n\n/**\n * Create a JSON log entry compatible with Datadog, CloudWatch, and ELK\n */\nexport function formatForJson(\n  level: LogLevel,\n  message: string,\n  context?: LogContext,\n  timestamp?: number | string,\n  logger?: string,\n  service?: string,\n  trace?: string,\n  error?: Error | unknown\n): JsonLogEntry {\n  const entry: JsonLogEntry = {\n    '@timestamp': formatTimestamp(timestamp),\n    level: formatLevelJson(level),\n    message,\n  };\n\n  if (context && Object.keys(context).length > 0) {\n    entry.context = context;\n  }\n\n  if (logger) {\n    entry.logger = logger;\n  }\n\n  if (service) {\n    entry.service = service;\n  }\n\n  if (trace) {\n    entry.trace = trace;\n  }\n\n  if (error) {\n    entry.error = formatError(error);\n  }\n\n  return entry;\n}\n\n/**\n * Format a log entry based on environment (dev = console, prod = JSON)\n */\nexport function formatLogEntry(\n  level: LogLevel,\n  message: string,\n  context?: LogContext,\n  timestamp?: number | string,\n  logger?: string,\n  service?: string,\n  trace?: string,\n  error?: Error | unknown\n): string {\n  const config = getConfig();\n\n  if (isDevelopment() && config.developmentFormat) {\n    return formatForConsole(level, message, context, timestamp);\n  }\n\n  const jsonEntry = formatForJson(\n    level,\n    message,\n    context,\n    timestamp,\n    logger,\n    service,\n    trace,\n    error\n  );\n\n  return JSON.stringify(jsonEntry);\n}\n\n/**\n * Format a browser log entry for localStorage\n */\nexport function formatBrowserLogEntry(\n  level: LogLevel,\n  message: string,\n  context?: LogContext\n): Omit<BrowserLogEntry, 'id' | 'timestamp'> {\n  return {\n    level,\n    message,\n    context,\n  };\n}\n\n/**\n * Format duration in human-readable format\n */\nexport function formatDuration(ms: number): string {\n  if (ms < 1) {\n    return `${(ms * 1000).toFixed(0)}μs`;\n  }\n  if (ms < 1000) {\n    return `${ms.toFixed(0)}ms`;\n  }\n  if (ms < 60000) {\n    return `${(ms / 1000).toFixed(2)}s`;\n  }\n  return `${(ms / 60000).toFixed(2)}m`;\n}\n\n/**\n * Truncate a string to a maximum length\n */\nexport function truncate(str: string, maxLength: number): string {\n  if (str.length <= maxLength) {\n    return str;\n  }\n  return `${str.slice(0, maxLength)}...`;\n}\n\n/**\n * Safely stringify an object for logging\n */\nexport function safeStringify(obj: unknown, maxLength: number = 10240): string {\n  try {\n    const str = JSON.stringify(obj);\n    return truncate(str, maxLength);\n  } catch {\n    return '[Unable to stringify]';\n  }\n}\n","/**\n * MIT License\n *\n * Copyright (c) 2026 Zaob <zaob.ogn@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Utility functions for API Logger Integration\n *\n * UUID generation, timestamp creation, and environment detection.\n */\n\n/**\n * Check if running in browser environment\n */\nexport function isBrowser(): boolean {\n  return typeof window !== 'undefined';\n}\n\n/**\n * Check if running in server environment\n */\nexport function isServer(): boolean {\n  return typeof window === 'undefined';\n}\n\n/**\n * Check if running in test environment\n */\nexport function isTest(): boolean {\n  return process.env['NODE_ENV'] === 'test';\n}\n\n/**\n * Generate a UUID v4 string\n * Uses crypto.randomUUID() if available, falls back to custom implementation\n */\nexport function generateUUID(): string {\n  // Use crypto.randomUUID() in Node.js 19+ and modern browsers\n  if (typeof crypto !== 'undefined' && crypto.randomUUID) {\n    return crypto.randomUUID();\n  }\n\n  // Fallback implementation for older environments\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\n/**\n * Generate a request ID (UUID v4)\n * Alias for generateUUID for semantic clarity\n */\nexport function generateRequestId(): string {\n  return generateUUID();\n}\n\n/**\n * Generate a unique ID with prefix\n */\nexport function generatePrefixedId(prefix: string): string {\n  return `${prefix}-${generateUUID()}`;\n}\n\n/**\n * Create a timestamp in ISO 8601 format\n */\nexport function createTimestamp(): string {\n  return new Date().toISOString();\n}\n\n/**\n * Create a Unix timestamp in milliseconds\n */\nexport function createUnixTimestamp(): number {\n  return Date.now();\n}\n\n/**\n * Parse ISO 8601 timestamp to Date object\n */\nexport function parseTimestamp(timestamp: string): Date {\n  return new Date(timestamp);\n}\n\n/**\n * Get current time in milliseconds for performance measurements\n */\nexport function getPerformanceNow(): number {\n  if (typeof performance !== 'undefined' && performance.now) {\n    return performance.now();\n  }\n  return Date.now();\n}\n\n/**\n * Debounce a function\n */\nexport function debounce<T extends (...args: unknown[]) => unknown>(\n  fn: T,\n  delay: number\n): (...args: Parameters<T>) => void {\n  let timeoutId: ReturnType<typeof setTimeout>;\n\n  return (...args: Parameters<T>) => {\n    clearTimeout(timeoutId);\n    timeoutId = setTimeout(() => fn(...args), delay);\n  };\n}\n\n/**\n * Throttle a function\n */\nexport function throttle<T extends (...args: unknown[]) => unknown>(\n  fn: T,\n  limit: number\n): (...args: Parameters<T>) => void {\n  let inThrottle = false;\n\n  return (...args: Parameters<T>) => {\n    if (!inThrottle) {\n      fn(...args);\n      inThrottle = true;\n      setTimeout(() => {\n        inThrottle = false;\n      }, limit);\n    }\n  };\n}\n\n/**\n * Safe JSON parse\n */\nexport function safeJsonParse<T>(json: string, fallback: T): T {\n  try {\n    return JSON.parse(json) as T;\n  } catch {\n    return fallback;\n  }\n}\n\n/**\n * Safe JSON stringify with fallback for circular references\n */\nexport function safeJsonStringify(obj: unknown): string {\n  try {\n    return JSON.stringify(obj);\n  } catch {\n    return '[Unable to stringify object]';\n  }\n}\n\n/**\n * Check if a value is a primitive (string, number, boolean, null, undefined)\n */\nexport function isPrimitive(value: unknown): boolean {\n  return value === null || (typeof value !== 'object' && typeof value !== 'function');\n}\n\n/**\n * Deep clone an object (simple implementation)\n */\nexport function deepClone<T>(obj: T): T {\n  if (isPrimitive(obj)) {\n    return obj;\n  }\n  return JSON.parse(JSON.stringify(obj)) as T;\n}\n\n/**\n * Merge objects deeply\n */\nexport function deepMerge<T extends Record<string, unknown>, U extends Record<string, unknown>>(\n  target: T,\n  source: U\n): T & U {\n  const output = { ...target } as T & U;\n\n  if (isObject(target) && isObject(source)) {\n    for (const key of Object.keys(source)) {\n      const sourceValue = source[key];\n      const targetValue = target[key];\n\n      if (isObject(sourceValue) && isObject(targetValue)) {\n        (output as Record<string, unknown>)[key] = deepMerge(\n          targetValue as Record<string, unknown>,\n          sourceValue as Record<string, unknown>\n        );\n      } else {\n        (output as Record<string, unknown>)[key] = sourceValue;\n      }\n    }\n  }\n\n  return output;\n}\n\n/**\n * Check if a value is an object (non-null, not a function)\n */\nfunction isObject(value: unknown): value is Record<string, unknown> {\n  return value !== null && typeof value === 'object' && !Array.isArray(value);\n}\n\n/**\n * Get a nested value from an object using dot notation\n */\nexport function getNestedValue<T>(obj: Record<string, unknown>, path: string, defaultValue: T): T {\n  const keys = path.split('.');\n  let current: unknown = obj;\n\n  for (const key of keys) {\n    if (current === null || current === undefined) {\n      return defaultValue;\n    }\n\n    if (typeof current === 'object') {\n      current = (current as Record<string, unknown>)[key];\n    } else {\n      return defaultValue;\n    }\n  }\n\n  return (current as T) ?? defaultValue;\n}\n\n/**\n * Set a nested value in an object using dot notation\n */\nexport function setNestedValue(obj: Record<string, unknown>, path: string, value: unknown): void {\n  const keys = path.split('.');\n  let current: Record<string, unknown> = obj;\n\n  for (let i = 0; i < keys.length - 1; i++) {\n    const key = keys[i] ?? '';\n\n    if (!(key in current) || !isObject(current[key])) {\n      current[key] = {};\n    }\n\n    current = current[key] as Record<string, unknown>;\n  }\n\n  const lastKey = keys[keys.length - 1] ?? '';\n  current[lastKey] = value;\n}\n","/**\n * MIT License\n *\n * Copyright (c) 2026 Zaob <zaob.ogn@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Browser-safe Logger Implementation\n *\n * Feature: 011-api-logger\n * User Story 1: Browser-Safe Client Logging\n *\n * This module provides a browser-safe logger that:\n * - Works in both CSR and SSR contexts\n * - Does NOT bundle Winston (pure browser code)\n * - Outputs to console with colored formatting in dev\n * - Persists logs to localStorage with quota management\n */\n\nimport { shouldLog, isLoggingEnabled, getConfig } from './config';\nimport { formatForConsole, formatForJson, formatBrowserLogEntry } from './formatters';\nimport type { IBrowserLogger, LogContext, LogLevel, BrowserLogEntry, StoredLogs } from './types';\nimport { generateUUID, createUnixTimestamp, isBrowser } from './utils';\n\n/**\n * Storage key for localStorage\n */\nconst STORAGE_KEY = 'glean_api_logs';\n\n/**\n * Maximum number of entries to store\n */\nconst MAX_ENTRIES = 100;\n\n/**\n * Default options for the browser logger\n */\ninterface BrowserLoggerOptions {\n  /** Maximum number of entries to store */\n  maxEntries?: number;\n  /** Custom storage key */\n  storageKey?: string;\n  /** Enable console output */\n  consoleEnabled?: boolean;\n  /** Enable localStorage persistence */\n  persistenceEnabled?: boolean;\n}\n\n/**\n * Browser logger implementation\n */\nclass BrowserLoggerImpl implements IBrowserLogger {\n  private options: Required<BrowserLoggerOptions>;\n  private config = getConfig();\n\n  constructor(options: BrowserLoggerOptions = {}) {\n    this.options = {\n      maxEntries: options.maxEntries ?? MAX_ENTRIES,\n      storageKey: options.storageKey ?? STORAGE_KEY,\n      consoleEnabled: options.consoleEnabled ?? true,\n      persistenceEnabled: options.persistenceEnabled ?? true,\n    };\n  }\n\n  /**\n   * Log a message at the specified level\n   */\n  private log(level: LogLevel, message: string, context?: LogContext): void {\n    if (!isLoggingEnabled()) {\n      return;\n    }\n\n    if (!shouldLog(level)) {\n      return;\n    }\n\n    const entry = formatBrowserLogEntry(level, message, context);\n    const timestamp = createUnixTimestamp();\n\n    // Console output\n    if (this.options.consoleEnabled) {\n      const formatted = formatForConsole(level, message, context, timestamp);\n      console.log(formatted);\n    }\n\n    // LocalStorage persistence\n    if (this.options.persistenceEnabled && isBrowser()) {\n      this.persistEntry(entry, timestamp);\n    }\n  }\n\n  /**\n   * Persist an entry to localStorage\n   */\n  private persistEntry(entry: Omit<BrowserLogEntry, 'id' | 'timestamp'>, timestamp: number): void {\n    if (!isBrowser()) {\n      return;\n    }\n\n    try {\n      const stored = this.getStoredLogsRaw();\n\n      const newEntry: BrowserLogEntry = {\n        ...entry,\n        id: generateUUID(),\n        timestamp,\n      };\n\n      stored.entries.push(newEntry);\n\n      while (stored.entries.length > this.options.maxEntries) {\n        stored.entries.shift();\n      }\n\n      stored.lastUpdated = timestamp;\n\n      localStorage.setItem(this.options.storageKey, JSON.stringify(stored));\n    } catch {\n      console.warn('[BrowserLogger] localStorage unavailable or quota exceeded');\n    }\n  }\n\n  /**\n   * Get raw stored logs from localStorage\n   */\n  private getStoredLogsRaw(): StoredLogs {\n    if (!isBrowser()) {\n      return { entries: [], lastUpdated: 0, version: 1 };\n    }\n\n    try {\n      const stored = localStorage.getItem(this.options.storageKey);\n      if (!stored) {\n        return { entries: [], lastUpdated: 0, version: 1 };\n      }\n\n      const parsed = JSON.parse(stored);\n      return {\n        entries: Array.isArray(parsed.entries) ? parsed.entries : [],\n        lastUpdated: parsed.lastUpdated || 0,\n        version: parsed.version || 1,\n      };\n    } catch {\n      return { entries: [], lastUpdated: 0, version: 1 };\n    }\n  }\n\n  debug(message: string, context?: LogContext): void {\n    this.log('debug', message, context);\n  }\n\n  info(message: string, context?: LogContext): void {\n    this.log('info', message, context);\n  }\n\n  warn(message: string, context?: LogContext): void {\n    this.log('warn', message, context);\n  }\n\n  error(message: string, context?: LogContext): void {\n    this.log('error', message, context);\n  }\n\n  getStoredLogs(): BrowserLogEntry[] {\n    const stored = this.getStoredLogsRaw();\n    return [...stored.entries].sort((a, b) => a.timestamp - b.timestamp);\n  }\n\n  clearStoredLogs(): void {\n    if (!isBrowser()) {\n      return;\n    }\n\n    try {\n      localStorage.removeItem(this.options.storageKey);\n    } catch {\n      console.warn('[BrowserLogger] Failed to clear stored logs');\n    }\n  }\n\n  async flush(): Promise<void> {\n    console.log('[BrowserLogger] flush() called - server sync not yet implemented');\n  }\n}\n\n/**\n * Singleton instance of the browser logger\n */\nlet instance: BrowserLoggerImpl | null = null;\n\n/**\n * Get or create the browser logger singleton\n */\nfunction getInstance(): BrowserLoggerImpl {\n  if (!instance) {\n    instance = new BrowserLoggerImpl();\n  }\n  return instance;\n}\n\n/**\n * Default export - singleton browser logger instance\n */\nconst browserLogger: IBrowserLogger = getInstance();\n\n/**\n * Factory function to create a new browser logger instance\n */\nfunction createBrowserLogger(options?: BrowserLoggerOptions): IBrowserLogger {\n  return new BrowserLoggerImpl(options);\n}\n\nexport default browserLogger;\nexport { browserLogger, createBrowserLogger, BrowserLoggerImpl };\n","/**\n * MIT License\n *\n * Copyright (c) 2026 Zaob <zaob.ogn@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Performance Timing Module\n *\n * Feature: 011-api-logger\n * User Story 5: Performance Timing\n *\n * Provides:\n * - High-resolution timing utilities\n * - API call duration tracking\n * - Slow operation detection\n * - Performance benchmarks\n */\n\nimport type { LogContext } from './types';\n\n/**\n * Get current high-resolution time in milliseconds\n */\nexport function now(): number {\n  // Use performance.now() if available, otherwise fallback to Date\n  // In Jest/node environment, we use a counter to ensure non-zero values\n  if (typeof performance !== 'undefined' && performance.now && performance.now() > 0) {\n    return performance.now();\n  }\n  // Fallback to Date with microsecond precision using process.hrtime if available\n  if (typeof process !== 'undefined' && process.hrtime) {\n    const [seconds, nanoseconds] = process.hrtime();\n    return seconds * 1000 + nanoseconds / 1000000;\n  }\n  // Final fallback to Date\n  return Date.now();\n}\n\n/**\n * Get current high-resolution time in microseconds\n */\nexport function nowMicro(): number {\n  return now() * 1000;\n}\n\n/**\n * Format duration in human-readable format\n */\nexport function formatDuration(ms: number): string {\n  if (ms < 1) {\n    return `${(ms * 1000).toFixed(2)}μs`;\n  }\n  if (ms < 1000) {\n    return `${ms.toFixed(2)}ms`;\n  }\n  if (ms < 60000) {\n    return `${(ms / 1000).toFixed(2)}s`;\n  }\n  return `${(ms / 60000).toFixed(2)}m`;\n}\n\n/**\n * Timing result interface\n */\nexport interface TimingResult {\n  /** Duration in milliseconds */\n  duration: number;\n  /** Formatted duration string */\n  formatted: string;\n  /** Start timestamp */\n  start: number;\n  /** End timestamp */\n  end: number;\n}\n\n/**\n * Measure execution time of a synchronous function\n */\nexport function time<T>(fn: () => T): TimingResult & { result: T } {\n  const start = now();\n  const result = fn();\n  const end = now();\n  const duration = Math.max(end - start, 0.01); // Ensure minimum duration for accurate measurement\n\n  return {\n    result,\n    duration,\n    formatted: formatDuration(duration),\n    start,\n    end,\n  };\n}\n\n/**\n * Measure execution time of an async function\n */\nexport async function timeAsync<T>(fn: () => Promise<T>): Promise<TimingResult & { result: T }> {\n  const start = now();\n  const result = await fn();\n  const end = now();\n  const duration = Math.max(end - start, 0.01);\n\n  return {\n    result,\n    duration,\n    formatted: formatDuration(duration),\n    start,\n    end,\n  };\n}\n\n/**\n * Stopwatch for manual timing control\n */\nexport class Stopwatch {\n  private startTime: number;\n  private laps: Map<string, number> = new Map();\n  private cumulativeTime = 0;\n  private running = true;\n\n  constructor() {\n    this.startTime = now();\n  }\n\n  /**\n   * Get elapsed time since stopwatch was created\n   */\n  elapsed(): number {\n    const current = now();\n    if (this.running) {\n      return Math.max(current - this.startTime, 0);\n    }\n    return this.cumulativeTime;\n  }\n\n  /**\n   * Get formatted elapsed time\n   */\n  formattedElapsed(): string {\n    return formatDuration(this.elapsed());\n  }\n\n  /**\n   * Record a lap time with a label\n   */\n  lap(label: string): number {\n    const lapTime = this.elapsed();\n    this.laps.set(label, lapTime);\n    return lapTime;\n  }\n\n  /**\n   * Get all recorded lap times\n   */\n  getLaps(): Map<string, number> {\n    return new Map(this.laps);\n  }\n\n  /**\n   * Get a specific lap time\n   */\n  getLap(label: string): number | undefined {\n    return this.laps.get(label);\n  }\n\n  /**\n   * Reset the stopwatch\n   */\n  reset(): void {\n    this.startTime = now();\n    this.laps.clear();\n    this.cumulativeTime = 0;\n    this.running = true;\n  }\n\n  /**\n   * Stop the stopwatch\n   */\n  stop(): number {\n    this.cumulativeTime = this.elapsed();\n    this.running = false;\n    return this.cumulativeTime;\n  }\n\n  /**\n   * Restart the stopwatch\n   */\n  restart(): Stopwatch {\n    this.reset();\n    return this;\n  }\n\n  /**\n   * Create a checkpoint that returns elapsed time\n   */\n  checkpoint(): number {\n    return this.elapsed();\n  }\n}\n\n/**\n * Performance threshold configuration\n */\nexport interface PerformanceThreshold {\n  /** Warning threshold in milliseconds */\n  warning: number;\n  /** Critical threshold in milliseconds */\n  critical: number;\n}\n\n/**\n * Default performance thresholds for different operation types\n */\nexport const DEFAULT_THRESHOLDS: Record<string, PerformanceThreshold> = {\n  api: { warning: 200, critical: 1000 },\n  db: { warning: 100, critical: 500 },\n  cache: { warning: 10, critical: 50 },\n  render: { warning: 16, critical: 100 }, // 16ms = 1 frame at 60fps\n  file: { warning: 50, critical: 200 },\n  external: { warning: 500, critical: 3000 },\n};\n\n/**\n * Performance level enumeration\n */\nexport enum PerformanceLevel {\n  OK = 'ok',\n  WARNING = 'warning',\n  CRITICAL = 'critical',\n}\n\n/**\n * Performance check result\n */\nexport interface PerformanceCheck {\n  /** Performance level */\n  level: PerformanceLevel;\n  /** Duration in milliseconds */\n  duration: number;\n  /** Formatted duration */\n  formatted: string;\n  /** Threshold that was exceeded (if any) */\n  threshold?: 'warning' | 'critical';\n  /** Message describing the performance status */\n  message: string;\n}\n\n/**\n * Check if a duration exceeds performance thresholds\n */\nexport function checkPerformance(\n  duration: number,\n  thresholds: PerformanceThreshold = DEFAULT_THRESHOLDS.api,\n  operationName = 'operation'\n): PerformanceCheck {\n  if (duration >= thresholds.critical) {\n    return {\n      level: PerformanceLevel.CRITICAL,\n      duration,\n      formatted: formatDuration(duration),\n      threshold: 'critical',\n      message: `${operationName} took too long (${formatDuration(duration)}, critical threshold: ${formatDuration(thresholds.critical)})`,\n    };\n  }\n\n  if (duration >= thresholds.warning) {\n    return {\n      level: PerformanceLevel.WARNING,\n      duration,\n      formatted: formatDuration(duration),\n      threshold: 'warning',\n      message: `${operationName} is slow (${formatDuration(duration)}, warning threshold: ${formatDuration(thresholds.warning)})`,\n    };\n  }\n\n  return {\n    level: PerformanceLevel.OK,\n    duration,\n    formatted: formatDuration(duration),\n    message: `${operationName} completed in ${formatDuration(duration)}`,\n  };\n}\n\n/**\n * Performance logger interface\n */\nexport interface IPerformanceLogger {\n  logOperation: (operation: string, duration: number, context?: LogContext) => void;\n  logSlowOperation: (\n    operation: string,\n    duration: number,\n    threshold: 'warning' | 'critical',\n    context?: LogContext\n  ) => void;\n}\n\n/**\n * No-op performance logger for production use when logging is disabled\n */\nexport const noopPerformanceLogger: IPerformanceLogger = {\n  logOperation: () => {},\n  logSlowOperation: () => {},\n};\n\n/**\n * Create a performance tracker with logging\n */\nexport function createPerformanceTracker(\n  logger: IPerformanceLogger,\n  defaultThresholds: PerformanceThreshold = DEFAULT_THRESHOLDS.api\n) {\n  return {\n    /**\n     * Track a synchronous operation\n     */\n    track<T>(operation: string, fn: () => T, context?: LogContext): TimingResult & { result: T } {\n      const start = now();\n      const result = fn();\n      const end = now();\n      const duration = Math.max(end - start, 0.01);\n\n      const check = checkPerformance(duration, defaultThresholds, operation);\n\n      if (check.level === PerformanceLevel.OK) {\n        logger.logOperation(operation, duration, context);\n      } else {\n        logger.logSlowOperation(operation, duration, check.threshold!, context);\n      }\n\n      return {\n        result,\n        duration,\n        formatted: formatDuration(duration),\n        start,\n        end,\n      };\n    },\n\n    /**\n     * Track an async operation\n     */\n    async trackAsync<T>(\n      operation: string,\n      fn: () => Promise<T>,\n      context?: LogContext\n    ): Promise<TimingResult & { result: T }> {\n      const start = now();\n      const result = await fn();\n      const end = now();\n      const duration = Math.max(end - start, 0.01);\n\n      const check = checkPerformance(duration, defaultThresholds, operation);\n\n      if (check.level === PerformanceLevel.OK) {\n        logger.logOperation(operation, duration, context);\n      } else {\n        logger.logSlowOperation(operation, duration, check.threshold!, context);\n      }\n\n      return {\n        result,\n        duration,\n        formatted: formatDuration(duration),\n        start,\n        end,\n      };\n    },\n\n    /**\n     * Create a stopwatch for manual timing\n     */\n    startTimer(): Stopwatch {\n      return new Stopwatch();\n    },\n\n    /**\n     * Check performance against thresholds\n     */\n    check(operation: string, duration: number): PerformanceCheck {\n      return checkPerformance(duration, defaultThresholds, operation);\n    },\n  };\n}\n\n/**\n * Throttled performance logger - only logs slow operations\n */\nexport function createThrottledLogger(\n  logger: IPerformanceLogger,\n  intervals: Record<'warning' | 'critical', number> = {\n    warning: 60000, // Log warning every minute\n    critical: 0, // Always log critical\n  }\n) {\n  const lastLogged: Map<string, number> = new Map();\n\n  return {\n    logOperation: (operation: string, duration: number, context?: LogContext) => {\n      logger.logOperation(operation, duration, context);\n    },\n    logSlowOperation: (\n      operation: string,\n      duration: number,\n      threshold: 'warning' | 'critical',\n      context?: LogContext\n    ) => {\n      const key = `${operation}:${threshold}`;\n      const currentTime = Date.now();\n      const last = lastLogged.get(key) ?? 0;\n\n      if (threshold === 'critical' || currentTime - last >= intervals[threshold]) {\n        logger.logSlowOperation(operation, duration, threshold, context);\n        lastLogged.set(key, currentTime);\n      }\n    },\n  };\n}\n\n/**\n * Performance metrics aggregator\n */\nexport class MetricsAggregator {\n  private metrics: Map<string, number[]> = new Map();\n\n  /**\n   * Record a timing value\n   */\n  record(key: string, value: number): void {\n    const existing = this.metrics.get(key) ?? [];\n    existing.push(value);\n    this.metrics.set(key, existing);\n  }\n\n  /**\n   * Get statistics for a metric\n   */\n  getStats(key: string): {\n    count: number;\n    min: number;\n    max: number;\n    avg: number;\n    p50: number;\n    p95: number;\n    p99: number;\n  } | null {\n    const values = this.metrics.get(key);\n    if (!values || values.length === 0) {\n      return null;\n    }\n\n    const sorted = [...values].sort((a, b) => a - b);\n    const count = sorted.length;\n    const min = sorted[0];\n    const max = sorted[count - 1];\n    const avg = sorted.reduce((a, b) => a + b, 0) / count;\n\n    const percentile = (p: number) => {\n      const idx = Math.floor(count * p);\n      return sorted[Math.min(idx, count - 1)];\n    };\n\n    return {\n      count,\n      min,\n      max,\n      avg,\n      p50: percentile(0.5),\n      p95: percentile(0.95),\n      p99: percentile(0.99),\n    };\n  }\n\n  /**\n   * Get all metric names\n   */\n  getMetricNames(): string[] {\n    return Array.from(this.metrics.keys());\n  }\n\n  /**\n   * Clear all metrics\n   */\n  clear(): void {\n    this.metrics.clear();\n  }\n}\n\n/**\n * Default export with all performance utilities\n */\nexport const perf = {\n  now,\n  nowMicro,\n  formatDuration,\n  time,\n  timeAsync,\n  Stopwatch,\n  DEFAULT_THRESHOLDS,\n  PerformanceLevel,\n  checkPerformance,\n  createPerformanceTracker,\n  createThrottledLogger,\n  MetricsAggregator,\n};\n\nexport default perf;\n","/**\n * MIT License\n *\n * Copyright (c) 2026 Zaob <zaob.ogn@gmail.com>\n *\n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n *\n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n *\n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n */\n\n/**\n * Browser-only Entry Point\n *\n * This file exports only browser-safe functionality.\n * Used by bundlers when building for the browser.\n */\n\nimport { createBrowserLogger, browserLogger } from './browser';\nimport { perf } from './timing';\nimport type { LogContext, LogLevel, IBrowserLogger } from './types';\n\nexport { perf as performance } from './timing';\n\n/**\n * Create a browser logger instance\n */\nexport function logger(options?: { name?: string; level?: LogLevel }): IBrowserLogger {\n  return createBrowserLogger({\n    consoleEnabled: true,\n    persistenceEnabled: true,\n    maxEntries: 100,\n    storageKey: 'glean_api_logs',\n  });\n}\n\n/**\n * Time an async operation (browser version)\n */\nexport async function measure<T>(\n  label: string,\n  fn: () => Promise<T>\n): Promise<{ result: T; duration: number }> {\n  const start = perf.now();\n  const result = await fn();\n  const duration = perf.now() - start;\n  return { result, duration };\n}\n\n// Re-export types\nexport type { IBrowserLogger, LogContext, LogLevel };\n"]}